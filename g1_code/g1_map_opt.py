import io
import os
import re
import shutil
import numpy as np
import pandas as pd

_path_1 = ['10-0.225', '10-0.375', '10-0.400', '10-0.450', '10-0.525', '10-0.650', '10-0.725',
           '500-0.725', '500-0.750', '600-0.675', '600-0.725', '600-0.750', '700-0.450', '700-0.525', '700-0.625',
           '700-0.650', '700-0.675', '700-0.725', '800-0.400', '800-0.450', '800-0.475', '800-0.550', '800-0.575',
           '800-0.600', '800-0.625', '800-0.650',
           '800-0.675', '800-0.700', '800-0.725', '800-0.750', '900-0.350', '900-0.375', '900-0.400', '900-0.425',
           '900-0.450', '900-0.475', '900-0.500', '900-0.525', '900-0.550', '900-0.575', '900-0.600', '900-0.625',
           '900-0.650', '900-0.675', '900-0.700', '900-0.725',
           '900-0.750', '1000-0.400', '1000-0.425', '1000-0.450', '1000-0.475', '1000-0.500', '1000-0.525',
           '1000-0.550', '1000-0.575',
           '1000-0.600', '1000-0.625', '1000-0.650', '1000-0.675', '1000-0.700', '1000-0.725', '1000-0.750',
           '1100-0.375', '1100-0.400', '1100-0.450', '1100-0.475', '1100-0.500', '1100-0.525', '1100-0.550',
           '1100-0.575', '1100-0.600', '1100-0.625', '1100-0.650', '1100-0.675', '1100-0.700', '1100-0.725',
           '1100-0.750', '1200-0.375', '1200-0.400', '1200-0.425', '1200-0.450', '1200-0.475', '1200-0.500',
           '1200-0.525', '1200-0.550', '1200-0.575', '1200-0.600', '1200-0.625', '1200-0.650', '1200-0.675',
           '1200-0.700', '1200-0.725', '1200-0.750', '1300-0.300', '1300-0.350', '1300-0.375', '1300-0.400',
           '1300-0.425', '1300-0.450', '1300-0.475', '1300-0.500', '1300-0.525', '1300-0.550', '1300-0.575',
           '1300-0.600', '1300-0.625', '1300-0.650', '1300-0.675', '1300-0.700', '1300-0.725', '1300-0.750']

_path_2 = ['10-0.125', '10-0.175', '10-0.250', '10-0.275', '10-0.450', '10-0.475', '10-0.725',
           '50-0.250', '50-0.425', '50-0.750',
           '200-0.625',
           '300-0.650', '300-0.725',
           '400-0.475', '400-0.600', '400-0.625',
           '500-0.475', '500-0.575', '500-0.750',
           '600-0.425', '600-0.450', '600-0.550', '600-0.575', '600-0.675',
           '700-0.550', '700-0.625', '700-0.725',
           '800-0.475', '800-0.650',
           '900-0.075', '900-0.275', '900-0.325', '900-0.400', '900-0.450', '900-0.625',
           '1000-0.075', '1000-0.400', '1000-0.450', '1000-0.625', '1000-0.725',
           '1100-0.325', '1100-0.400', '1100-0.625', '1100-0.700',
           '1200-0.450', '1100-0.550', '1100-0.650', '1100-0.750',
           '1300-0.400', '1300-0.450', '1300-0.650', '1300-0.675']

_path_3 = ['10-0.175','10-0.250', '10-0.300', '10-0.375', '10-0.450', '10-0.550', '10-0.650', '10-0.750', '50-0.175', '50-0.250', '50-0.300',
 '50-0.375', '50-0.425', '50-0.500', '50-0.550', '50-0.650', '50-0.750', '100-0.125', '100-0.200', '100-0.275', '100-0.350', '100-0.400', '100-0.450',
 '100-0.550', '100-0.600', '100-0.750', '200-0.200', '200-0.250', '200-0.425', '200-0.625', '200-0.725', '300-0.100', '300-0.225', '300-0.275', '300-0.475',
 '300-0.575', '300-0.675', '400-0.125', '400-0.250', '400-0.300', '400-0.550', '400-0.600', '400-0.650', '400-0.750', '500-0.100', '500-0.225', '500-0.300',
 '500-0.400', '500-0.450', '500-0.500', '500-0.575', '500-0.625', '500-0.750', '600-0.100', '600-0.175', '600-0.225', '600-0.425', '600-0.550', '600-0.675',
 '600-0.750', '700-0.150', '700-0.425', '700-0.500', '700-0.575', '700-0.625', '700-0.725', '800-0.150', '800-0.200', '800-0.275', '800-0.475', '800-0.600',
 '800-0.675', '800-0.750', '900-0.100', '900-0.150', '900-0.225', '900-0.275', '900-0.400', '900-0.475', '900-0.525', '900-0.575', '900-0.650', '900-0.750',
 '1000-0.100', '1000-0.175', '1000-0.275', '1000-0.325', '1000-0.400', '1000-0.450', '1000-0.550', '1000-0.600', '1000-0.675', '1000-0.725', '1100-0.100',
 '1100-0.175', '1100-0.275', '1100-0.325', '1100-0.400', '1100-0.475', '1100-0.525', '1100-0.575', '1100-0.625', '1100-0.700', '1200-0.150', '1200-0.400',
 '1200-0.550', '1200-0.650', '1200-0.725', '1300-0.175', '1300-0.275', '1300-0.350', '1300-0.400', '1300-0.450', '1300-0.500', '1300-0.550', '1300-0.675']


_path_4 = ['10-0.150',
 '10-0.250',
 '10-0.300',
 '10-0.375',
 '10-0.475',
 '10-0.525',
 '10-0.575',
 '10-0.650',
 '10-0.750',
 '50-0.150',
 '50-0.225',
 '50-0.275',
 '50-0.350',
 '50-0.400',
 '50-0.500',
 '50-0.575',
 '50-0.725',
 '100-0.200',
 '100-0.275',
 '100-0.350',
 '100-0.400',
 '100-0.450',
 '100-0.550',
 '100-0.600',
 '100-0.725',
 '200-0.200',
 '200-0.250',
 '200-0.400',
 '200-0.450',
 '200-0.625',
 '200-0.725',
 '300-0.100',
 '300-0.250',
 '300-0.300',
 '300-0.475',
 '300-0.600',
 '300-0.675',
 '400-0.150',
 '400-0.250',
 '400-0.300',
 '400-0.550',
 '400-0.600',
 '400-0.750',
 '500-0.225',
 '500-0.425',
 '500-0.525',
 '500-0.575',
 '500-0.625',
 '500-0.725',
 '600-0.175',
 '600-0.425',
 '600-0.575',
 '600-0.675',
 '600-0.725',
 '700-0.150',
 '700-0.425',
 '700-0.475',
 '700-0.550',
 '700-0.625',
 '700-0.725',
 '800-0.150',
 '800-0.200',
 '800-0.275',
 '800-0.475',
 '800-0.600',
 '800-0.675',
 '800-0.750',
 '900-0.200',
 '900-0.275',
 '900-0.400',
 '900-0.475',
 '900-0.575',
 '900-0.650',
 '900-0.750',
 '1000-0.125',
 '1000-0.325',
 '1000-0.400',
 '1000-0.450',
 '1000-0.550',
 '1000-0.600',
 '1000-0.675',
 '1000-0.750',
 '1100-0.125',
 '1100-0.175',
 '1100-0.325',
 '1100-0.400',
 '1100-0.475',
 '1100-0.575',
 '1100-0.625',
 '1100-0.725',
 '1200-0.150',
 '1200-0.400',
 '1200-0.550',
 '1200-0.650',
 '1200-0.750',
 '1300-0.175',
 '1300-0.300',
 '1300-0.350',
 '1300-0.400',
 '1300-0.450',
 '1300-0.500',
 '1300-0.550',
 '1300-0.650']

_path_5 = ['10-0.075',
 '50-0.075',
 '100-0.075',
 '200-0.075',
 '300-0.075',
 '400-0.075',
 '500-0.075',
 '600-0.075',
 '700-0.075',
 '800-0.075',
 '900-0.075',
 '1000-0.075',
 '1100-0.075',
 '1200-0.075',
 '1300-0.075',
 '10-0.100',
 '50-0.100',
 '100-0.100',
 '200-0.100',
 '300-0.100',
 '400-0.100',
 '500-0.100',
 '600-0.100',
 '700-0.100',
 '800-0.100',
 '900-0.100',
 '1000-0.100',
 '1100-0.100',
 '1200-0.100',
 '1300-0.100',
 '10-0.125',
 '50-0.125',
 '100-0.125',
 '200-0.125',
 '300-0.125',
 '400-0.125',
 '500-0.125',
 '600-0.125',
 '700-0.125',
 '800-0.125',
 '900-0.125',
 '1000-0.125',
 '1100-0.125',
 '1200-0.125',
 '1300-0.125',
 '10-0.150',
 '50-0.150',
 '100-0.150',
 '200-0.150',
 '300-0.150',
 '400-0.150',
 '500-0.150',
 '600-0.150',
 '700-0.150',
 '800-0.150',
 '900-0.150',
 '1000-0.150',
 '1100-0.150',
 '1200-0.150',
 '1300-0.150',
 '10-0.175',
 '50-0.175',
 '100-0.175',
 '200-0.175',
 '300-0.175',
 '400-0.175',
 '500-0.175',
 '600-0.175',
 '700-0.175',
 '800-0.175',
 '900-0.175',
 '1000-0.175',
 '1100-0.175',
 '1200-0.175',
 '1300-0.175',
 '10-0.200',
 '50-0.200',
 '100-0.200',
 '200-0.200',
 '300-0.200',
 '400-0.200',
 '500-0.200',
 '600-0.200',
 '700-0.200',
 '800-0.200',
 '900-0.200',
 '1000-0.200',
 '1100-0.200',
 '1200-0.200',
 '1300-0.200',
 '10-0.225',
 '50-0.225',
 '100-0.225',
 '200-0.225',
 '300-0.225',
 '400-0.225',
 '500-0.225',
 '600-0.225',
 '700-0.225',
 '800-0.225',
 '900-0.225',
 '1000-0.225',
 '1100-0.225',
 '1200-0.225',
 '1300-0.225',
 '10-0.250',
 '50-0.250',
 '100-0.250',
 '200-0.250',
 '300-0.250',
 '400-0.250',
 '500-0.250',
 '600-0.250',
 '700-0.250',
 '800-0.250',
 '900-0.250',
 '1000-0.250',
 '1100-0.250',
 '1200-0.250',
 '1300-0.250',
 '10-0.275',
 '50-0.275',
 '100-0.275',
 '200-0.275',
 '300-0.275',
 '400-0.275',
 '500-0.275',
 '600-0.275',
 '700-0.275',
 '800-0.275',
 '900-0.275',
 '1000-0.275',
 '1100-0.275',
 '1200-0.275',
 '1300-0.275',
 '10-0.300',
 '50-0.300',
 '100-0.300',
 '200-0.300',
 '300-0.300',
 '400-0.300',
 '500-0.300',
 '600-0.300',
 '700-0.300',
 '800-0.300',
 '900-0.300',
 '1000-0.300',
 '1100-0.300',
 '1200-0.300',
 '1300-0.300']

_path_6 = ['10-0.075',
 '10-0.100',
 '10-0.125',
 '10-0.150',
 '10-0.175',
 '10-0.200',
 '10-0.225',
 '10-0.250',
 '10-0.275',
 '10-0.300',
 '10-0.325',
 '10-0.350',
 '10-0.375',
 '10-0.400',
 '10-0.425',
 '10-0.450',
 '10-0.475',
 '10-0.500',
 '10-0.525',
 '10-0.550',
 '10-0.575',
 '10-0.600',
 '10-0.625',
 '10-0.650',
 '10-0.675',
 '10-0.700',
 '10-0.725',
 '10-0.750',
 '50-0.075',
 '50-0.100',
 '50-0.125',
 '50-0.150',
 '50-0.175',
 '50-0.200',
 '50-0.225',
 '50-0.250',
 '50-0.275',
 '50-0.300',
 '50-0.325',
 '50-0.350',
 '50-0.375',
 '50-0.400',
 '50-0.425',
 '50-0.450',
 '50-0.475',
 '50-0.500',
 '50-0.525',
 '50-0.550',
 '50-0.575',
 '50-0.600',
 '50-0.625',
 '50-0.650',
 '50-0.675',
 '50-0.700',
 '50-0.725',
 '50-0.750',
 '100-0.075',
 '100-0.100',
 '100-0.125',
 '100-0.150',
 '100-0.175',
 '100-0.200',
 '100-0.225',
 '100-0.250',
 '100-0.275',
 '100-0.300',
 '100-0.325',
 '100-0.350',
 '100-0.375',
 '100-0.400',
 '100-0.425',
 '100-0.450',
 '100-0.475',
 '100-0.500',
 '100-0.525',
 '100-0.550',
 '100-0.575',
 '100-0.600',
 '100-0.625',
 '100-0.650',
 '100-0.675',
 '100-0.700',
 '100-0.725',
 '100-0.750',
 '200-0.075',
 '200-0.100',
 '200-0.125',
 '200-0.150',
 '200-0.175',
 '200-0.200',
 '200-0.225',
 '200-0.250',
 '200-0.275',
 '200-0.300',
 '200-0.325',
 '200-0.350',
 '200-0.375',
 '200-0.400',
 '200-0.425',
 '200-0.450',
 '200-0.475',
 '200-0.500',
 '200-0.525',
 '200-0.550',
 '200-0.575',
 '200-0.600',
 '200-0.625',
 '200-0.650',
 '200-0.675',
 '200-0.700',
 '200-0.725',
 '200-0.750',
 '300-0.075',
 '300-0.100',
 '300-0.125',
 '300-0.150',
 '300-0.175',
 '300-0.200',
 '300-0.225',
 '300-0.250',
 '300-0.275',
 '300-0.300',
 '300-0.325',
 '300-0.350',
 '300-0.375',
 '300-0.400',
 '300-0.425',
 '300-0.450',
 '300-0.475',
 '300-0.500',
 '300-0.525',
 '300-0.550',
 '300-0.575',
 '300-0.600',
 '300-0.625',
 '300-0.650',
 '300-0.675',
 '300-0.700',
 '300-0.725',
 '300-0.750',
 '400-0.075',
 '400-0.100',
 '400-0.125',
 '400-0.150',
 '400-0.175',
 '400-0.200',
 '400-0.225',
 '400-0.250',
 '400-0.275',
 '400-0.300',
 '400-0.325',
 '400-0.350',
 '400-0.375',
 '400-0.400',
 '400-0.425',
 '400-0.450',
 '400-0.475',
 '400-0.500',
 '400-0.525',
 '400-0.550',
 '400-0.575',
 '400-0.600',
 '400-0.625',
 '400-0.650',
 '400-0.675',
 '400-0.700',
 '400-0.725',
 '400-0.750']




_path_8 = ['10-0.150',
 '10-0.225',
 '10-0.275',
 '10-0.325',
 '10-0.375',
 '10-0.450',
 '10-0.575',
 '10-0.625',
 '10-0.675',
 '10-0.725',
 '50-0.200',
 '50-0.250',
 '50-0.325',
 '50-0.400',
 '50-0.575',
 '50-0.725',
 '100-0.125',
 '100-0.200',
 '100-0.250',
 '100-0.350',
 '100-0.450',
 '100-0.600',
 '100-0.750',
 '200-0.100',
 '200-0.200',
 '200-0.300',
 '200-0.375',
 '200-0.450',
 '200-0.550',
 '200-0.600',
 '200-0.750',
 '300-0.150',
 '300-0.225',
 '300-0.300',
 '300-0.400',
 '300-0.450',
 '300-0.500',
 '300-0.575',
 '300-0.700',
 '400-0.125',
 '400-0.225',
 '400-0.275',
 '400-0.575',
 '400-0.700',
 '500-0.125',
 '500-0.250',
 '500-0.425',
 '500-0.575',
 '500-0.650',
 '500-0.725',
 '600-0.200',
 '600-0.400',
 '600-0.575',
 '600-0.650',
 '600-0.700',
 '600-0.750',
 '700-0.150',
 '700-0.425',
 '700-0.550',
 '700-0.625',
 '700-0.750',
 '800-0.125',
 '800-0.250',
 '800-0.450',
 '800-0.500',
 '800-0.675',
 '800-0.750',
 '900-0.200',
 '900-0.275',
 '900-0.400',
 '900-0.500',
 '900-0.575',
 '900-0.650',
 '900-0.750',
 '1000-0.125',
 '1000-0.400',
 '1000-0.450',
 '1000-0.550',
 '1000-0.625',
 '1000-0.750',
 '1100-0.125',
 '1100-0.400',
 '1100-0.475',
 '1100-0.575',
 '1100-0.625',
 '1100-0.725',
 '1200-0.400',
 '1200-0.525',
 '1200-0.575',
 '1200-0.625',
 '1200-0.725',
 '1300-0.125',
 '1300-0.200',
 '1300-0.300',
 '1300-0.350',
 '1300-0.400',
 '1300-0.450',
 '1300-0.500',
 '1300-0.550',
 '1300-0.625',
 '1300-0.675']



_path_9 = ['600-0.075',
 '600-0.100',
 '600-0.125',
 '600-0.150',
 '600-0.175',
 '600-0.200',
 '700-0.075',
 '700-0.100',
 '700-0.125',
 '700-0.150',
 '700-0.175',
 '700-0.200',
 '800-0.075',
 '800-0.100',
 '800-0.125',
 '800-0.150',
 '800-0.175',
 '800-0.200',
 '900-0.075',
 '900-0.100',
 '900-0.125',
 '900-0.150',
 '900-0.175',
 '900-0.200',
 '1000-0.075',
 '1000-0.100',
 '1000-0.125',
 '1000-0.150',
 '1000-0.175',
 '1000-0.200',
 '1100-0.075',
 '1100-0.100',
 '1100-0.125',
 '1100-0.150',
 '1100-0.175',
 '1100-0.200',
 '1200-0.075',
 '1200-0.100',
 '1200-0.125',
 '1200-0.150',
 '1200-0.175',
 '1200-0.200',
 '1300-0.075',
 '1300-0.100',
 '1300-0.125',
 '1300-0.150',
 '1300-0.175',
 '1300-0.200']

_path_10 = ['10-0.075',
 '10-0.100',
 '50-0.075',
 '50-0.100',
 '100-0.075',
 '100-0.100',
 '200-0.075',
 '200-0.100',
 '300-0.075',
 '300-0.100',
 '400-0.075',
 '400-0.100',
 '500-0.075',
 '500-0.100',
 '600-0.075',
 '600-0.100',
 '700-0.075',
 '700-0.100',
 '800-0.075',
 '800-0.100',
 '900-0.075',
 '900-0.100',
 '1000-0.075',
 '1000-0.100',
 '1100-0.075',
 '1100-0.100',
 '1200-0.075',
 '1200-0.100',
 '1300-0.075',
 '1300-0.100']
_path_11 = ['10-0.075',
 '10-0.100',
 '50-0.075',
 '50-0.100',
 '100-0.075',
 '100-0.100',
 '200-0.075',
 '200-0.100',
 '300-0.075',
 '300-0.100',
 '400-0.075',
 '400-0.100',
 '500-0.075',
 '500-0.100',
 '600-0.075',
 '600-0.100',
 '700-0.075',
 '700-0.100',
 '800-0.075',
 '800-0.100',
 '900-0.075',
 '900-0.100',
 '1000-0.075',
 '1000-0.100',
 '1100-0.075',
 '1100-0.100',
 '1200-0.075',
 '1200-0.100',
 '1300-0.075',
 '1300-0.100']
path_0000 = _path_10
df_data = pd.DataFrame(index=path_0000, columns=np.arange(4))
ii = 0
for e_r in path_0000:
    pattern = r'[\d.]+'
    eta_drs_str = re.findall(pattern, e_r)
    eta_str = eta_drs_str[0]
    drs_str = eta_drs_str[1]
    eta_num = int(eta_str)
    drs_num = float(drs_str)
    drs_num = '{:.3f}'.format(drs_num)
    path_111 = '/work/mse-minzw/lrz/g1/{}-{}/recal10/'.format(eta_num, drs_num)
    path_111_pred = path_111 + 'pred.log'
    path_111_pyamff = path_111 + 'pyamff.log'

    file_pred = open(path_111_pred)
    out_pred = file_pred.readlines()
    rmse_pred = out_pred[-36]
    pattern_pred = r'[\d.]+'
    number_pred = re.findall(pattern_pred, rmse_pred)
    EnergyRMSE_str_pred = number_pred[0]
    ForceRMSE_str_pred = number_pred[1]
    EnergyRMSE_pred = float(EnergyRMSE_str_pred)
    ForceRMSE_pred = float(ForceRMSE_str_pred)
    df_data.iloc[ii, 2] = EnergyRMSE_pred
    df_data.iloc[ii, 3] = ForceRMSE_pred

    file_pyamff = open(path_111_pyamff)
    out_pyamff = file_pyamff.readlines()
    rmse_pyamff = out_pyamff[-1]
    num_list_pyamff = rmse_pyamff.split()
    EnergyRMSE_pyamff = float(num_list_pyamff[-2])
    ForceRMSE_pyamff = float(num_list_pyamff[-1])
    df_data.iloc[ii, 0] = EnergyRMSE_pyamff
    df_data.iloc[ii, 1] = ForceRMSE_pyamff

    ii += 1
    print(path_111)

with pd.ExcelWriter('./g1_map_opt.xlsx') as writer2:
    df_data.to_excel(writer2, sheet_name='g1_opt')
